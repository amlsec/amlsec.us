!function(win){var startTime=Date.now();if(!win.performance)win.performance={};win.performance.now=function(){return Date.now()-startTime}}(window);!function(win){var rafPrefix;if(!('requestAnimationFrame'in win)){if('mozRequestAnimationFrame'in win)rafPrefix='moz';else if('webkitRequestAnimationFrame'in win)rafPrefix="webkit";if(rafPrefix){win.requestAnimationFrame=function(callback){return win[rafPrefix+'RequestAnimationFrame'](function(){callback(performance.now())})};win.cancelAnimationFrame=win[rafPrefix+'CancelAnimationFrame']}else{var lastTime=Date.now();win.requestAnimationFrame=function(callback){if(typeof callback!=='function')throw new TypeError(callback+' is not a function');var currentTime=Date.now(),delay=16+lastTime-currentTime;if(delay<0)delay=0;lastTime=currentTime;return setTimeout(function(){lastTime=Date.now();callback(performance.now())},delay)};win.cancelAnimationFrame=function(id){clearTimeout(id)}}}}(window);!function(win,doc){if(typeof win.Element==='undefined'||'classList'in doc.documentElement)return;var push=Array.prototype.push,splice=Array.prototype.splice,join=Array.prototype.join;function DOMTokenList(el){this.el=el;var classes=el.className.replace(/^\s+|\s+$/g,'').split(/\s+/);for(var i=0;i<classes.length;i++)push.call(this,classes[i])}DOMTokenList.prototype={add:function(token){if(this.contains(token))return;push.call(this,token);this.el.className=this.toString()},contains:function(token){return this.el.className.indexOf(token)!=-1},item:function(index){return this[index]||null},remove:function(token){if(!this.contains(token))return;for(var i=0;i<this.length;i++)if(this[i]==token)break;splice.call(this,i,1);this.el.className=this.toString()},toString:function(){return join.call(this,' ')},toggle:function(token){if(!this.contains(token))this.add(token);else this.remove(token);return this.contains(token)}};win.DOMTokenList=DOMTokenList;function defineElementGetter(obj,prop,getter){if(Object.defineProperty)Object.defineProperty(obj,prop,{get:getter});else obj.__defineGetter__(prop,getter)}defineElementGetter(Element.prototype,'classList',function(){return new DOMTokenList(this)})}(window,document);!function(doc){var supportsPassive=false;doc.createElement('div').addEventListener('test',function(){},{get passive(){supportsPassive=true;return false}});if(!supportsPassive){var parseOptions=function(type,listener,options,action){var needsWrapping=false;var useCapture=false;var passive=false;var fieldId;if(options)if(typeof options==='object'){passive=options.passive?true:false;useCapture=options.useCapture?true:false}else useCapture=options;if(passive)needsWrapping=true;if(needsWrapping){fieldId=useCapture.toString();fieldId+=passive.toString()}action(needsWrapping,fieldId,useCapture,passive)};var super_add_event_listener=EventTarget.prototype.addEventListener;var super_remove_event_listener=EventTarget.prototype.removeEventListener;var super_prevent_default=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){if(this.__passive){console.warn('Ignored attempt to preventDefault an event from a passive listener');return}super_prevent_default.apply(this)};EventTarget.prototype.addEventListener=function(type,listener,options){var super_this=this;parseOptions(type,listener,options,function(needsWrapping,fieldId,useCapture,passive){if(needsWrapping){var fieldId=useCapture.toString();fieldId+=passive.toString();if(!this.__event_listeners_options)this.__event_listeners_options={};if(!this.__event_listeners_options[type])this.__event_listeners_options[type]={};if(!this.__event_listeners_options[type][listener])this.__event_listeners_options[type][listener]=[];if(this.__event_listeners_options[type][listener][fieldId])return;var wrapped={handleEvent:function(e){e.__passive=passive;if(typeof listener==='function')listener(e);else listener.handleEvent(e);e.__passive=false}};this.__event_listeners_options[type][listener][fieldId]=wrapped;super_add_event_listener.call(super_this,type,wrapped,useCapture)}else super_add_event_listener.call(super_this,type,listener,useCapture)})};EventTarget.prototype.removeEventListener=function(type,listener,options){var super_this=this;parseOptions(type,listener,options,function(needsWrapping,fieldId,useCapture,passive){if(needsWrapping&&this.__event_listeners_options&&this.__event_listeners_options[type]&&this.__event_listeners_options[type][listener]&&this.__event_listeners_options[type][listener][fieldId]){super_remove_event_listener.call(super_this,type,this.__event_listeners_options[type][listener][fieldId],false);delete this.__event_listeners_options[type][listener][fieldId];if(this.__event_listeners_options[type][listener].length===0)delete this.__event_listeners_options[type][listener]}else super_remove_event_listener.call(super_this,type,listener,useCapture)})}}}(document);
